<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>منتدى العشيرة</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBo_O8EKeS6jYM-ee12oYrIlT575oaU2Pg",
      authDomain: "clan-forum.firebaseapp.com",
      projectId: "clan-forum",
      storageBucket: "clan-forum.firebasestorage.app",
      messagingSenderId: "1011903491894",
      appId: "1:1011903491894:web:f1bc46a549e74b3717cd97",
      measurementId: "G-G6D8V7KSNH"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    document.addEventListener("DOMContentLoaded", () => {
      const loginBtn = document.getElementById("googleLoginBtn");

      if (loginBtn) {
        loginBtn.addEventListener("click", () => {
          signInWithPopup(auth, provider)
            .then((result) => {
              console.log("تم تسجيل الدخول:", result.user);
              window.location.href = "profile.html";
            })
            .catch((error) => console.error("خطأ:", error));
        });
      }

      onAuthStateChanged(auth, (user) => {
        if (user) {
          document.getElementById("loginBtnContainer").innerHTML =
            `<span class="user-name">مرحباً، ${user.displayName}</span>`;
        }
      });

      // ====== نظام الإعجاب ======
      const likeButton = document.getElementById('likeBtn');
      const likeCountSpan = document.getElementById('likeCount');
      let likes = parseInt(localStorage.getItem("likes") || "0");
      let liked = localStorage.getItem("liked") === "true";

      likeCountSpan.textContent = likes;
      if (liked) likeButton.classList.add("liked");

      likeButton.addEventListener('click', () => {
        if (liked) {
          likes--;
          liked = false;
          likeButton.classList.remove('liked');
        } else {
          likes++;
          liked = true;
          likeButton.classList.add('liked');
        }
        likeCountSpan.textContent = likes;
        localStorage.setItem("likes", likes);
        localStorage.setItem("liked", liked);
      });

      // ====== نظام التعليقات ======
      const commentButton = document.getElementById('commentBtn');
      const commentsContainer = document.getElementById('commentsContainer');
      let comments = JSON.parse(localStorage.getItem("comments") || "[]");
      let commentsVisible = false;

      function renderComments() {
        commentsContainer.innerHTML = `
          <div class="comment-input-area">
            <input type="text" id="newCommentInput" placeholder="اكتب تعليقك هنا...">
            <button id="addCommentBtn">إضافة تعليق</button>
          </div>
        `;
        comments.forEach(c => {
          const div = document.createElement('div');
          div.classList.add('comment');
          div.innerHTML = `<div class="comment-author">عضو جديد</div><div class="comment-text">${c}</div>`;
          commentsContainer.insertBefore(div, commentsContainer.querySelector('.comment-input-area'));
        });

        document.getElementById('addCommentBtn').addEventListener('click', () => {
          const input = document.getElementById('newCommentInput');
          const text = input.value.trim();
          if (text) {
            comments.push(text);
            localStorage.setItem("comments", JSON.stringify(comments));
            renderComments();
          } else {
            alert("الرجاء كتابة تعليق!");
          }
        });
      }

      commentButton.addEventListener('click', () => {
        if (!commentsVisible) {
          renderComments();
          commentsVisible = true;
        } else {
          commentsContainer.innerHTML = '';
          commentsVisible = false;
        }
      });
    });
  </script>
</head>
<body>
  <header class="main-header">
    <nav class="navbar">
      <div class="nav-left">
        <a href="groups.html" class="nav-icon"><i class="fas fa-users"></i><span>المجموعات</span></a>
        <a href="updates.html" class="nav-icon"><i class="fas fa-bullhorn"></i><span>التحديثات</span></a>
        <a href="notifications.html" class="nav-icon"><i class="fas fa-bell"></i><span>الإشعارات</span></a>
      </div>
      <div class="nav-right" id="loginBtnContainer">
        <button id="googleLoginBtn" class="auth-btn"><i class="fab fa-google"></i> تسجيل الدخول</button>
      </div>
    </nav>
  </header>

  <main class="container">
    <section class="admin-message-section">
      <div class="message-card">
        <h2>رسالة من إدارة المنتدى</h2>
        <p>
          أهلاً وسهلاً بكم في منتدى العشيرة! هذا المكان مخصص للتواصل الهادف وتبادل الخبرات بين الأعضاء.
          نرجو من الجميع الالتزام بقوانين المنتدى واحترام الآخرين.
        </p>

        <div class="message-actions">
          <button id="likeBtn" class="action-btn"><i class="fas fa-heart"></i> إعجاب (<span id="likeCount">0</span>)</button>
          <button id="commentBtn" class="action-btn"><i class="fas fa-comment"></i> تعليق</button>
        </div>

        <div id="commentsContainer" class="comments-section"></div>
      </div>
    </section>
  </main>

  <footer class="main-footer">
    <p>&copy; 2025 منتدى العشيرة. جميع الحقوق محفوظة.</p>
  </footer>
</body>
</html>